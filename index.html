<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no" />
    <title>Task Garden</title>
    <style>
        :root {
            --bg: #020617;
            --card: rgba(30, 41, 59, 0.4);
            --muted: #94a3b8;
            --accent: #38bdf8;
            --green: #4ade80;
            --yellow: #facc15; 
            --red: #ef4444;
            --border: rgba(255, 255, 255, 0.1);
        }
a
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        html, body { 
            margin: 0; padding: 0; height: 100vh; width: 100%; 
            background: var(--bg); color: #fff;
            font-family: -apple-system, system-ui, sans-serif;
            overflow: hidden;
            height: -webkit-fill-available;
        }

        body { background: radial-gradient(circle at top right, #0f172a, #020617); }

        /* Splash Screen */
        #splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 2000; 
            /* Smooth fade out */
            transition: opacity 0.8s ease, visibility 0.8s;
            padding: 2.5rem; text-align: center;
        }
        #splash-quote {
            font-size: 1.1rem; font-weight: 300; font-style: italic; line-height: 1.6;
            max-width: 600px; color: #fff; margin-bottom: 20px;
            opacity: 0; transform: translateY(10px); animation: fadeInUp 1.5s forwards 0.2s;
        }
        #splash-author { font-size: 0.8rem; color: var(--accent); opacity: 0; animation: fadeInUp 0.8s forwards 0.5s; letter-spacing: 1px; text-transform: uppercase; }
        
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        .hidden { opacity: 0; visibility: hidden; pointer-events: none; }

        /* Navigation */
        .nav-dots {
            position: fixed; bottom: calc(env(safe-area-inset-bottom) + 20px);
            left: 50%; transform: translateX(-50%); display: flex; gap: 12px; z-index: 100;
        }
        .dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(255, 255, 255, 0.2); transition: 0.3s; }
        .dot.active { background: var(--accent); transform: scale(1.5); }

        #screen-container { display: flex; width: 400%; height: 100%; transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1); }

        .view { 
            width: 25%; height: 100%; overflow-y: auto; padding: 1.2rem; 
            padding-top: calc(env(safe-area-inset-top) + 20px); padding-bottom: 200px;
        }

        /* Compact Task Cards */
        .task-card {
            background: var(--card); backdrop-filter: blur(12px);
            border-radius: 16px; padding: 0.6rem 0.8rem; margin-bottom: 0.6rem;
            border: 1px solid var(--border); transition: 0.3s;
            display: flex; align-items: center; gap: 10px;
        }
        .ping-flash { background: rgba(74, 222, 128, 0.3) !important; border-color: var(--green) !important; transform: scale(1.02); }
        
        .growth-stage-icon { font-size: 1.6rem; cursor: pointer; flex-shrink: 0; display: flex; align-items: center; }
        
        .task-main { flex: 1; min-width: 0; overflow: hidden; }
        .task-name { font-weight: 500; font-size: 0.95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .harvest-meta { font-size: 0.7rem; color: var(--green); margin-top: -2px; }

        .growth-controls { display: flex; align-items: center; gap: 6px; flex-shrink: 0; }
        .percent-badge { font-weight: 800; color: var(--accent); font-size: 0.8rem; min-width: 35px; text-align: center; }
        
        .step-btn {
            background: rgba(255,255,255,0.08); border: none; color: #fff;
            width: 28px; height: 28px; border-radius: 8px; font-size: 1.1rem; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }
        .step-btn:disabled { opacity: 0.1; }
        
        .del-btn { background: none; border: none; color: var(--red); font-size: 1.4rem; cursor: pointer; padding: 0 4px; line-height: 1; }

        .input-bar { position: fixed; bottom: calc(env(safe-area-inset-bottom) + 70px); left: 1.2rem; right: 1.2rem; z-index: 10; }
        .input-box { background: rgba(15, 23, 42, 0.95); border-radius: 18px; padding: 8px 12px; display: flex; gap: 8px; border: 1px solid var(--border); }
        input[type="text"] { background: none; border: none; color: #fff; flex: 1; outline: none; font-size: 1rem; }
        
        .sound-toggle { margin-bottom: 10px; padding: 10px; background: var(--card); border-radius: 10px; cursor: pointer; border: 1px solid var(--border); }
        .archive-toolbar { display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px; }
        .tool-btn { background: rgba(56, 189, 248, 0.1); border: 1px solid var(--accent); color: var(--accent); padding: 10px; border-radius: 10px; font-size: 0.8rem; font-weight: bold; cursor: pointer; text-align: center; }
        .tool-btn-secondary { background: none; border: 1px solid var(--border); color: var(--muted); padding: 10px; border-radius: 10px; font-size: 0.8rem; text-align: center; cursor: pointer; }
    </style>
</head>
<body>

<div id="splash-screen">
    <div id="splash-quote">"Focusing your mind..."</div>
    <div id="splash-author"></div>
</div>

<div class="nav-dots">
    <div class="dot active"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
</div>

<div id="screen-container">
    <div class="view">
        <h2 style="color: var(--accent); margin-top:0;">Mindful Space</h2>
        <div style="display: flex; gap: 8px; margin-bottom: 20px;">
            <div class="sound-toggle" style="flex:1; margin:0; text-align:center;" onclick="toggleSound('storm')">‚ö° Storm</div>
            <div class="sound-toggle" style="flex:1; margin:0; text-align:center;" onclick="toggleSound('birds')">üê¶ Birdsong</div>
        </div>
        <div style="text-align: center; margin-top: 30px;">
            <div style="font-size: 4rem; font-weight: 800; letter-spacing: -2px;" id="timeDisplay">25:00</div>
            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                <button onclick="toggleTimer()" id="timerBtn" style="background:var(--accent); color:var(--bg); border:none; padding:12px 30px; border-radius:30px; font-weight:bold;">Start Focus</button>
                <button onclick="resetTimer()" id="resetBtn" style="background:transparent; border:1px solid var(--border); color:var(--muted); padding:12px 20px; border-radius:30px; font-weight:bold; display: none;">Reset</button>
            </div>
        </div>
    </div>

    <div class="view">
        <h2 style="color: var(--accent); margin-top:0;">Inbox</h2>
        <div id="inbox-list"></div>
    </div>

    <div class="view">
        <h2 style="color: var(--yellow); margin-top:0;">Daily Focus</h2>
        <div id="focus-list"></div>
    </div>

    <div class="view">
        <h2 style="color: var(--muted); margin-top:0;">Completed Tasks</h2>
        <div class="archive-toolbar">
            <button class="tool-btn" onclick="exportToCSV()">üì§ Export tasks.csv</button>
            <label class="tool-btn-secondary">üì• Import tasks.csv <input type="file" accept=".csv" onchange="importCSV(event)" style="display:none;"></label>
        </div>
        <div id="archive-list"></div>
    </div>
</div>

<div class="input-bar">
    <div class="input-box">
        <input type="text" id="taskInput" placeholder="New task..." autocomplete="off">
        <button onclick="addTask()" style="background:var(--accent); border:none; border-radius:12px; width:40px; height:40px; color:#020617; font-weight:bold;">+</button>
    </div>
</div>

<audio id="stormAudio" loop src="storm.mp3"></audio>
<audio id="birdsAudio" loop src="birdsong.mp3"></audio>
<audio id="pingAudio" src="ping.mp3"></audio>
<audio id="bellAudio" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>

<script>
    const quotes = [
        { q: "Life is about making an impact, not making an income.", a: "Kevin Kruse" },
        { q: "Whatever the mind of man can conceive and believe, it can achieve.", a: "Napoleon Hill" },
        { q: "Strive not to be a success, but rather to be of value.", a: "Albert Einstein" },
        { q: "Two roads diverged in a wood, and I‚ÄîI took the one less traveled by.", a: "Robert Frost" },
        { q: "I attribute my success to this: I never gave or took any excuse.", a: "Florence Nightingale" },
        { q: "You miss 100% of the shots you don‚Äôt take.", a: "Wayne Gretzky" },
        { q: "I've missed more than 9000 shots in my career. I've failed over and over and over again.", a: "Michael Jordan" },
        { q: "The most difficult thing is the decision to act, the rest is merely tenacity.", a: "Amelia Earhart" },
        { q: "Every strike brings me closer to the next home run.", a: "Babe Ruth" },
        { q: "Definiteness of purpose is the starting point of all achievement.", a: "W. Clement Stone" },
        { q: "Life isn't about getting and having, it's about giving and being.", a: "Kevin Kruse" },
        { q: "Life is what happens to you while you‚Äôre busy making other plans.", a: "John Lennon" },
        { q: "We become what we think about.", a: "Earl Nightingale" },
        { q: "Twenty years from now you will be more disappointed by the things that you didn‚Äôt do.", a: "Mark Twain" },
        { q: "Life is 10% what happens to me and 90% of how I react to it.", a: "Charles Swindoll" },
        { q: "The most common way people give up their power is by thinking they don‚Äôt have any.", a: "Alice Walker" },
        { q: "The mind is everything. What you think you become.", a: "Buddha" },
        { q: "The best time to plant a tree was 20 years ago. The second best time is now.", a: "Chinese Proverb" },
        { q: "An unexamined life is not worth living.", a: "Socrates" },
        { q: "Eighty percent of success is showing up.", a: "Woody Allen" },
        { q: "Your time is limited, so don‚Äôt waste it living someone else‚Äôs life.", a: "Steve Jobs" },
        { q: "Winning isn‚Äôt everything, but wanting to win is.", a: "Vince Lombardi" },
        { q: "I am not a product of my circumstances. I am a product of my decisions.", a: "Stephen Covey" },
        { q: "Every child is an artist. The problem is how to remain an artist once he grows up.", a: "Pablo Picasso" },
        { q: "You can never cross the ocean until you have the courage to lose sight of the shore.", a: "Christopher Columbus" },
        { q: "I‚Äôve learned that people will forget what you said, but people will never forget how you made them feel.", a: "Maya Angelou" },
        { q: "Either you run the day, or the day runs you.", a: "Jim Rohn" },
        { q: "Whether you think you can or you think you can‚Äôt, you‚Äôre right.", a: "Henry Ford" },
        { q: "The two most important days in your life are the day you are born and the day you find out why.", a: "Mark Twain" },
        { q: "Whatever you can do, or dream you can, begin it. Boldness has genius, power and magic in it.", a: "Goethe" },
        { q: "The best revenge is massive success.", a: "Frank Sinatra" },
        { q: "People often say that motivation doesn‚Äôt last. Well, neither does bathing. That‚Äôs why we recommend it daily.", a: "Zig Ziglar" },
        { q: "Life shrinks or expands in proportion to one's courage.", a: "Anais Nin" },
        { q: "If you hear a voice within you say 'you cannot paint,' then by all means paint and that voice will be silenced.", a: "Vincent Van Gogh" },
        { q: "There is only one way to avoid criticism: do nothing, say nothing, and be nothing.", a: "Aristotle" },
        { q: "Ask and it will be given to you; search, and you will find; knock and the door will be opened for you.", a: "Jesus" },
        { q: "The only person you are destined to become is the person you decide to be.", a: "Ralph Waldo Emerson" },
        { q: "Go confidently in the direction of your dreams. Live the life you have imagined.", a: "Henry David Thoreau" },
        { q: "When I stand before God at the end of my life, I would hope that I would not have a single bit of talent left and could say, I used everything you gave me.", a: "Erma Bombeck" },
        { q: "Few things can help an individual more than to place responsibility on him, and to let him know that you trust him.", a: "Booker T. Washington" },
        { q: "Certain things catch your eye, but pursue only those that capture the heart.", a: "Ancient Indian Proverb" },
        { q: "Believe you can and you‚Äôre halfway there.", a: "Theodore Roosevelt" },
        { q: "Everything you‚Äôve ever wanted is on the other side of fear.", a: "George Addair" },
        { q: "We can easily forgive a child who is afraid of the dark; the real tragedy of life is when men are afraid of the light.", a: "Plato" },
        { q: "Teach thy tongue to say, 'I do not know,' and thou shalt progress.", a: "Maimonides" },
        { q: "Start where you are. Use what you have. Do what you can.", a: "Arthur Ashe" },
        { q: "When I was 5 years old, my mother always told me that happiness was the key to life.", a: "John Lennon" },
        { q: "Fall seven times and stand up eight.", a: "Japanese Proverb" },
        { q: "When one door of happiness closes, another opens.", a: "Helen Keller" },
        { q: "Everything has beauty, but not everyone can see.", a: "Confucius" },
        { q: "How wonderful it is that nobody need wait a single moment before starting to improve the world.", a: "Anne Frank" },
        { q: "When I let go of what I am, I become what I might be.", a: "Lao Tzu" },
        { q: "Life is not measured by the number of breaths we take, but by the moments that take our breath away.", a: "Maya Angelou" },
        { q: "Happiness is not something readymade. It comes from your own actions.", a: "Dalai Lama" },
        { q: "If you're offered a seat on a rocket ship, don't ask what seat! Just get on.", a: "Sheryl Sandberg" },
        { q: "First, have a definite, clear practical ideal; a goal, an objective.", a: "Aristotle" },
        { q: "If the wind will not serve, take to the oars.", a: "Latin Proverb" },
        { q: "You can‚Äôt fall if you don‚Äôt climb. But there‚Äôs no joy in living your whole life on the ground.", a: "Unknown" },
        { q: "We must believe that we are gifted for something, and that this thing, at whatever cost, must be attained.", a: "Marie Curie" },
        { q: "Too many of us are not living our dreams because we are living our fears.", a: "Les Brown" },
        { q: "Challenges are what make life interesting and overcoming them is what makes life meaningful.", a: "Joshua J. Marine" },
        { q: "If you want to lift yourself up, lift up someone else.", a: "Booker T. Washington" },
        { q: "Knowing is not enough; we must apply. Being willing is not enough; we must do.", a: "Leonardo da Vinci" },
        { q: "Limitations live only in our minds. But if we use our imaginations, our possibilities become limitless.", a: "Jamie Paolinetti" },
        { q: "You take your life in your own hands, and what happens? A terrible thing, no one to blame.", a: "Erica Jong" },
        { q: "What‚Äôs money? A man is a success if he gets up in the morning and goes to bed at night and in between does what he wants to do.", a: "Bob Dylan" },
        { q: "I didn‚Äôt fail the test. I just found 100 ways to do it wrong.", a: "Benjamin Franklin" },
        { q: "In order to succeed, your desire for success should be greater than your fear of failure.", a: "Bill Cosby" },
        { q: "A person who never made a mistake never tried anything new.", a: "Albert Einstein" },
        { q: "The person who says it cannot be done should not interrupt the person who is doing it.", a: "Chinese Proverb" },
        { q: "There are no traffic jams along the extra mile.", a: "Roger Staubach" },
        { q: "It is never too late to be what you might have been.", a: "George Eliot" },
        { q: "You become what you believe.", a: "Oprah Winfrey" },
        { q: "I would rather die of passion than of boredom.", a: "Vincent van Gogh" },
        { q: "A truly rich man is one whose children run into his arms when his hands are empty.", a: "Unknown" },
        { q: "It is not what you do for your children, but what you have taught them to do for themselves.", a: "Ann Landers" },
        { q: "If you want your children to turn out well, spend twice as much time with them, and half as much money.", a: "Abigail Van Buren" },
        { q: "Build your own dreams, or someone else will hire you to build theirs.", a: "Farrah Gray" },
        { q: "The invisible battles inside all of us--that's where it's at.", a: "Jesse Owens" },
        { q: "Education costs money. But then so does ignorance.", a: "Sir Claus Moser" },
        { q: "I have learned over the years that when one's mind is made up, this diminishes fear.", a: "Rosa Parks" },
        { q: "It does not matter how slowly you go as long as you do not stop.", a: "Confucius" },
        { q: "If you look at what you have in life, you'll always have more.", a: "Oprah Winfrey" },
        { q: "Remember that not getting what you want is sometimes a wonderful stroke of luck.", a: "Dalai Lama" },
        { q: "You can‚Äôt use up creativity. The more you use, the more you have.", a: "Maya Angelou" },
        { q: "Dream big and dare to fail.", a: "Norman Vaughan" },
        { q: "Our lives begin to end the day we become silent about things that matter.", a: "Martin Luther King Jr." },
        { q: "Do what you can, where you are, with what you have.", a: "Teddy Roosevelt" },
        { q: "If you do what you‚Äôve always done, you‚Äôll get what you‚Äôve always gotten.", a: "Tony Robbins" },
        { q: "Dreaming, after all, is a form of planning.", a: "Gloria Steinem" },
        { q: "It's your place in the world; it's your life. Go on and do all you can with it.", a: "Mae Jemison" },
        { q: "You may be disappointed if you fail, but you are doomed if you don't try.", a: "Beverly Sills" },
        { q: "Remember no one can make you feel inferior without your consent.", a: "Eleanor Roosevelt" },
        { q: "Life is what we make it, always has been, always will be.", a: "Grandma Moses" },
        { q: "The question isn‚Äôt who is going to let me; it‚Äôs who is going to stop me.", a: "Ayn Rand" },
        { q: "When everything seems against you, remember the airplane takes off against the wind.", a: "Henry Ford" },
        { q: "It‚Äôs not the years in your life that count. It‚Äôs the life in your years.", a: "Abraham Lincoln" },
        { q: "Change your thoughts and you change your world.", a: "Norman Vincent Peale" },
        { q: "Either write something worth reading or do something worth writing.", a: "Benjamin Franklin" },
        { q: "Nothing is impossible, the word itself says, 'I‚Äôm possible!'", a: "Audrey Hepburn" },
        { q: "The only way to do great work is to love what you do.", a: "Steve Jobs" },
        { q: "If you can dream it, you can achieve it.", a: "Zig Ziglar" }
    ];

    function initSplash() {
        const now = new Date();
        const start = new Date(now.getFullYear(), 0, 0);
        const day = Math.floor((now - start) / (1000 * 60 * 60 * 24));
        const quote = quotes[day % quotes.length];
        document.getElementById('splash-quote').innerText = `"${quote.q}"`;
        document.getElementById('splash-author').innerText = `‚Äî ${quote.a}`;
        
        // Hide after exactly 2 seconds (2000ms)
        setTimeout(() => {
            document.getElementById('splash-screen').classList.add('hidden');
        }, 3000);
    }

    let tasks = JSON.parse(localStorage.getItem('Tasks') || '[]');
    let currentPane = 1;
    let timerSeconds = 25 * 60;
    let timerInterval = null;
    const growthIcons = { 0: 'ü´ò', 25: 'üå±', 50: 'üåø', 75: 'ü™¥', 100: 'üå≥' };

    function save() { localStorage.setItem('Tasks', JSON.stringify(tasks)); render(); }

    function render() {
        const lists = { inbox: document.getElementById('inbox-list'), focus: document.getElementById('focus-list'), archive: document.getElementById('archive-list') };
        Object.values(lists).forEach(l => l.innerHTML = '');

        tasks.forEach(t => {
            const card = document.createElement('div');
            card.className = 'task-card';
            const icon = t.done ? 'üå≥' : growthIcons[t.progress];
            
            card.innerHTML = `
                <div class="growth-stage-icon" onclick="toggleFocus(${t.id})">${icon}</div>
                <div class="task-main">
                    <div class="task-name" style="${t.done ? 'text-decoration:line-through; opacity:0.6;' : ''}">${t.text}</div>
                    ${t.done ? `<div class="harvest-meta">Harvested ‚Ä¢ ${t.completedDate || ''}</div>` : ''}
                </div>
                ${!t.done ? `
                    <div class="growth-controls">
                        <button class="step-btn" onclick="adjustProgress(${t.id}, -1, this)" ${t.progress===0?'disabled':''}>‚àí</button>
                        <div class="percent-badge">${t.progress}%</div>
                        <button class="step-btn" onclick="adjustProgress(${t.id}, 1, this)" ${t.progress===100?'disabled':''}>+</button>
                    </div>
                ` : ''}
                <button class="del-btn" onclick="deleteTask(${t.id})">&times;</button>
            `;
            
            if(t.done) lists.archive.appendChild(card);
            else if(t.focus) lists.focus.appendChild(card);
            else lists.inbox.appendChild(card);
        });
    }

    function adjustProgress(id, dir, el) {
        const t = tasks.find(x => x.id === id);
        const steps = [0, 25, 50, 75, 100];
        let idx = steps.indexOf(t.progress) + dir;
        if (idx >= 0 && idx < steps.length) {
            const old = t.progress; t.progress = steps[idx];
            if (t.progress === 100 && old < 100) {
                t.done = true;
                t.completedDate = new Date().toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
                document.getElementById('pingAudio').play().catch(()=>{});
                el.closest('.task-card').classList.add('ping-flash');
                setTimeout(save, 400);
            } else { t.done = (t.progress === 100); if(!t.done) delete t.completedDate; save(); }
        }
    }

    function toggleFocus(id) { const t = tasks.find(x => x.id === id); if(!t.done) { t.focus = !t.focus; save(); } }
    function addTask() { 
        const i = document.getElementById('taskInput'); 
        if(!i.value.trim()) return; 
        tasks.push({ id: Date.now(), text: i.value, progress: 0, done: false, focus: currentPane === 2 }); 
        i.value = ''; save(); 
    }
    function deleteTask(id) { if(confirm("Cancel task?")) { tasks = tasks.filter(t => t.id !== id); save(); } }
    function toggleSound(s) { const a = document.getElementById(s+'Audio'); a.paused ? a.play() : a.pause(); }

    function updateTimerDisplay() {
        const m = Math.floor(timerSeconds/60), s = timerSeconds%60;
        document.getElementById('timeDisplay').innerText = `${m}:${s<10?'0':''}${s}`;
    }

    function toggleTimer() {
        const btn = document.getElementById('timerBtn'), resetBtn = document.getElementById('resetBtn');
        if (timerInterval) { clearInterval(timerInterval); timerInterval = null; btn.innerText = 'Resume'; }
        else {
            if (timerSeconds <= 0) timerSeconds = 25 * 60;
            btn.innerText = 'Pause'; resetBtn.style.display = 'block';
            timerInterval = setInterval(() => {
                timerSeconds--; updateTimerDisplay();
                if (timerSeconds <= 0) { 
                    clearInterval(timerInterval); timerInterval = null;
                    btn.innerText = 'Start Focus'; document.getElementById('bellAudio').play().catch(()=>{});
                    alert("Focus session complete!"); 
                }
            }, 1000);
        }
    }

    function resetTimer() {
        clearInterval(timerInterval); timerInterval = null; timerSeconds = 25 * 60;
        updateTimerDisplay(); document.getElementById('timerBtn').innerText = 'Start Focus';
        document.getElementById('resetBtn').style.display = 'none';
    }

    function exportToCSV() {
        let csv = "id,text,progress,done,focus,completedDate\n";
        tasks.forEach(t => csv += `${t.id},"${t.text.replace(/"/g, '""')}",${t.progress},${t.done},${t.focus},"${t.completedDate||''}"\n`);
        const b = new Blob([csv], { type: 'text/csv' });
        const l = document.createElement("a"); l.href = URL.createObjectURL(b); l.download = "tasks.csv"; l.click();
    }

    function importCSV(e) {
        const file = e.target.files[0]; if (!file) return;
        const reader = new FileReader();
        reader.onload = function(event) {
            try {
                const rows = event.target.result.split('\n').slice(1);
                tasks = rows.filter(r => r.trim()).map(row => {
                    const p = row.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
                    return { id: parseInt(p[0]), text: p[1].replace(/"/g, ''), progress: parseInt(p[2]), done: p[3].trim()==='true', focus: p[4].trim()==='true', completedDate: p[5]?p[5].replace(/"/g, ''):null };
                });
                save();
            } catch(err) { alert("Format Error"); }
        };
        reader.readAsText(file);
    }

    const container = document.getElementById('screen-container');
    let startX = 0, isDragging = false;
    container.ontouchstart = (e) => { if (['BUTTON', 'INPUT', 'LABEL'].includes(e.target.tagName)) return; isDragging = true; startX = e.touches[0].pageX; container.style.transition = 'none'; };
    window.ontouchmove = (e) => { if (!isDragging) return; const d = e.touches[0].pageX - startX; const m = (currentPane * -25) + (d / window.innerWidth * 25); container.style.transform = `translateX(${m}%)`; };
    window.ontouchend = (e) => { if (!isDragging) return; isDragging = false; const d = e.changedTouches[0].pageX - startX; if (Math.abs(d) > 50) { if (d < 0 && currentPane < 3) currentPane++; else if (d > 0 && currentPane > 0) currentPane--; } updateLayout(); };
    function updateLayout() { container.style.transition = 'transform 0.5s cubic-bezier(0.16, 1, 0.3, 1)'; container.style.transform = `translateX(${currentPane * -25}%)`; document.querySelectorAll('.dot').forEach((d, i) => d.classList.toggle('active', i === currentPane)); }

    initSplash(); updateLayout(); render();
    document.getElementById('taskInput').addEventListener('keypress', (e) => { if(e.key === 'Enter') addTask(); });
</script>
</body>
</html>
